<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>数据链路功能 | XDU 953 House</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/img/leaf.ico">
    <link rel="stylesheet" href="/css/katex0.15.1.min.css">
    <script src="/js/katex0.15.1.min.js"></script>
    <script src="/js/jquery1.9.1.min.js"></script>
    <script src="/js/crypto.js"></script>
    <script src="/js/md5.js"></script>
    <link rel="stylesheet" href="/css/button.css">
    <meta name="description" content="片刻寧靜">
    
    <link rel="preload" href="/assets/css/0.styles.dee84450.css" as="style"><link rel="preload" href="/assets/js/app.464b2a28.js" as="script"><link rel="preload" href="/assets/js/2.f539a802.js" as="script"><link rel="preload" href="/assets/js/1.74843084.js" as="script"><link rel="preload" href="/assets/js/30.7c04ffad.js" as="script"><link rel="prefetch" href="/assets/js/10.921445e1.js"><link rel="prefetch" href="/assets/js/11.e4895d61.js"><link rel="prefetch" href="/assets/js/12.cba02928.js"><link rel="prefetch" href="/assets/js/13.b4fea8f9.js"><link rel="prefetch" href="/assets/js/14.eb0bf0f2.js"><link rel="prefetch" href="/assets/js/15.2f4cbb95.js"><link rel="prefetch" href="/assets/js/16.ca772779.js"><link rel="prefetch" href="/assets/js/17.1f24fd4d.js"><link rel="prefetch" href="/assets/js/18.84ef48e2.js"><link rel="prefetch" href="/assets/js/19.f8969fd3.js"><link rel="prefetch" href="/assets/js/20.eac09a2e.js"><link rel="prefetch" href="/assets/js/21.0d2dbedb.js"><link rel="prefetch" href="/assets/js/22.cc515833.js"><link rel="prefetch" href="/assets/js/23.dd83e4f1.js"><link rel="prefetch" href="/assets/js/24.56d64ff8.js"><link rel="prefetch" href="/assets/js/25.1c0c1474.js"><link rel="prefetch" href="/assets/js/26.0a2297ed.js"><link rel="prefetch" href="/assets/js/27.5f1af55f.js"><link rel="prefetch" href="/assets/js/28.96a2e9b9.js"><link rel="prefetch" href="/assets/js/29.04313390.js"><link rel="prefetch" href="/assets/js/3.f3113a3f.js"><link rel="prefetch" href="/assets/js/31.c10c8375.js"><link rel="prefetch" href="/assets/js/32.683356de.js"><link rel="prefetch" href="/assets/js/33.7269e8ba.js"><link rel="prefetch" href="/assets/js/34.7f4a41b2.js"><link rel="prefetch" href="/assets/js/35.2d2e1c38.js"><link rel="prefetch" href="/assets/js/36.9e5c5ff7.js"><link rel="prefetch" href="/assets/js/37.15da9b29.js"><link rel="prefetch" href="/assets/js/38.12fc08d8.js"><link rel="prefetch" href="/assets/js/39.6bb478b3.js"><link rel="prefetch" href="/assets/js/4.4d73d019.js"><link rel="prefetch" href="/assets/js/40.7bd5e9df.js"><link rel="prefetch" href="/assets/js/41.9992730b.js"><link rel="prefetch" href="/assets/js/42.b9ea5cbd.js"><link rel="prefetch" href="/assets/js/43.1830ed9e.js"><link rel="prefetch" href="/assets/js/44.e8fff894.js"><link rel="prefetch" href="/assets/js/45.81ab4634.js"><link rel="prefetch" href="/assets/js/46.819b1ad8.js"><link rel="prefetch" href="/assets/js/47.780e3064.js"><link rel="prefetch" href="/assets/js/48.86771a41.js"><link rel="prefetch" href="/assets/js/49.ff389619.js"><link rel="prefetch" href="/assets/js/5.f4693a95.js"><link rel="prefetch" href="/assets/js/50.2b8165da.js"><link rel="prefetch" href="/assets/js/51.536d1912.js"><link rel="prefetch" href="/assets/js/52.66e9128b.js"><link rel="prefetch" href="/assets/js/53.0607ace0.js"><link rel="prefetch" href="/assets/js/54.e44d762a.js"><link rel="prefetch" href="/assets/js/55.7ba6d36e.js"><link rel="prefetch" href="/assets/js/56.015bc6c9.js"><link rel="prefetch" href="/assets/js/57.6935f8e2.js"><link rel="prefetch" href="/assets/js/58.b7045388.js"><link rel="prefetch" href="/assets/js/6.f2c56be6.js"><link rel="prefetch" href="/assets/js/7.992cee86.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.d63322e5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.dee84450.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/error.jpg" alt="XDU 953 House" class="logo"> <span class="site-name can-hide">XDU 953 House</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/ds/" class="nav-link">
  数据结构
</a></div><div class="nav-item"><a href="/cn/" class="nav-link router-link-active">
  计算机网络
</a></div><div class="nav-item"><a href="/crypto/" class="nav-link">
  密码学
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/ds/" class="nav-link">
  数据结构
</a></div><div class="nav-item"><a href="/cn/" class="nav-link router-link-active">
  计算机网络
</a></div><div class="nav-item"><a href="/crypto/" class="nav-link">
  密码学
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>计算机网络基础</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/cn/basics/computer-network-outline-physical.html" class="sidebar-link">计网体系结构和物理层</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>数据链路层</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/cn/basics/computer-network-data-link.html" aria-current="page" class="active sidebar-link">数据链路功能</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cn/basics/computer-network-data-link.html#链路层概述" class="sidebar-link">链路层概述</a></li><li class="sidebar-sub-header"><a href="/cn/basics/computer-network-data-link.html#组帧" class="sidebar-link">组帧</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cn/basics/computer-network-data-link.html#帧的界定" class="sidebar-link">帧的界定</a></li></ul></li><li class="sidebar-sub-header"><a href="/cn/basics/computer-network-data-link.html#差错控制" class="sidebar-link">差错控制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cn/basics/computer-network-data-link.html#奇偶校验码" class="sidebar-link">奇偶校验码</a></li><li class="sidebar-sub-header"><a href="/cn/basics/computer-network-data-link.html#循环冗余码" class="sidebar-link">循环冗余码</a></li><li class="sidebar-sub-header"><a href="/cn/basics/computer-network-data-link.html#海明码" class="sidebar-link">海明码</a></li></ul></li><li class="sidebar-sub-header"><a href="/cn/basics/computer-network-data-link.html#流量控制与可靠传输机制" class="sidebar-link">流量控制与可靠传输机制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cn/basics/computer-network-data-link.html#流量控制-滑动窗口机制" class="sidebar-link">流量控制 - 滑动窗口机制</a></li><li class="sidebar-sub-header"><a href="/cn/basics/computer-network-data-link.html#可靠传输-自动重传请求机制" class="sidebar-link">可靠传输 - 自动重传请求机制</a></li></ul></li><li class="sidebar-sub-header"><a href="/cn/basics/computer-network-data-link.html#介质访问控制" class="sidebar-link">介质访问控制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cn/basics/computer-network-data-link.html#信道划分介质" class="sidebar-link">信道划分介质</a></li><li class="sidebar-sub-header"><a href="/cn/basics/computer-network-data-link.html#随机访问介质-争用式" class="sidebar-link">随机访问介质 - 争用式</a></li><li class="sidebar-sub-header"><a href="/cn/basics/computer-network-data-link.html#轮询访问-令牌传输协议" class="sidebar-link">轮询访问：令牌传输协议</a></li></ul></li></ul></li><li><a href="/cn/basics/computer-network-lan-wan.html" class="sidebar-link">局域网和广域网</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>网络层</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/cn/basics/computer-network-transport-application.html" class="sidebar-link">传输层和应用层</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TCP/IP Socket in C</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>链路是一条<strong>逻辑信道</strong>，建立在物理信道之上，并不是物理存在的通路，网络层和更上层的连接也一样，所谓主机到主机的连接或者是端口到端口的连接，都是一种逻辑连接，在物理层之上通过各种协议封装而成，最终数据都是以比特流的形式通过物理信道传输，这是要明确的</p> <p>该章和网络层是考察重点</p> <h2 id="链路层概述">链路层概述</h2> <p>为网络层提供服务：其基本功能就是把网络层的数据（分组）从源机器传输到目的机器的网络层</p> <p>链路管理：链路层可以提供面向连接的可靠的服务，在这样的服务中链路管理是必须的</p> <p>界定帧、帧同步和透明传输：通过封装比特流的头部和尾部将一个个帧分隔；接收方要给予某种反馈来实现帧传输的同步</p> <p>流量控制：针对发送方的控制，防止发的太多导致接收方带宽不够接收出错</p> <p>差错控制：出错了怎么办，ARQ 法，采用 CRC 冗余校验和 ARQ 自动重传请求，确认帧是否被正确接收，并保证每个帧最终都能有且只能有一次正确的接收</p> <h2 id="组帧">组帧</h2> <blockquote><p>帧需要实现帧界定、透明传输、可靠传输等功能</p></blockquote> <h3 id="帧的界定">帧的界定</h3> <p>帧需要首尾来界定，因为这是封装的第一层，封装的对象是比特流，需要首尾共同截取一段比特流来组成帧</p> <table><thead><tr><th>界定帧的方法</th> <th></th></tr></thead> <tbody><tr><td>字符计数法</td> <td>在首部用一个计数段来表示当前帧的长度，如 21354322 则表示三个帧 21、354、322，显然若计数段出错数据将发生毁灭性的错误</td></tr> <tr><td>首尾字符串定界法</td> <td>采用固定的字符 SOH / ETO 表示帧的开始和结束，同时用转义字符 ESC 来表示数据段中的 SOH 和 ETO 串</td></tr> <tr><td>首尾比特串定界法</td> <td>用 01111110 表示首尾，数据段每碰到五个连续的 1，追加一个 0，接收方再去掉数据段每五个连续的 1 之后的 0 得到源数据</td></tr> <tr><td>违规编码法</td> <td>适用于曼彻斯特编码，因为在这种编码中，每一个码元，高电平到低电平表 1，低电平到高电平表 0，高到高和低到低不存在（违规），于是很巧妙地用这种违规的码元来界定帧地开始和结束</td></tr></tbody></table> <p>举个栗子</p> <img src="/assets/img/image-20230614011548265.521fa416.png"> <img src="/assets/img/image-20230614011609030.b1fc7a6b.png"> <p>信息段对界定方法的处理方式即为透明传输（信息段除了是一串二进制数之外没有任何含义，需要向上拆封识别）</p> <h2 id="差错控制">差错控制</h2> <blockquote><p>比特差错控制：奇偶校验码、循环冗余码、海明码</p></blockquote> <p>差错（比特差错）：在比特流传输过程中，1 变为 0，0 变为 1，这样的错误叫做比特差错</p> <p>利用<strong>编码技术</strong>进行差错控制，编码分为两类</p> <ul><li>检错编码，自动重传请求 ARQ</li> <li>纠错编码，前向纠错 FEC</li></ul> <h3 id="奇偶校验码">奇偶校验码</h3> <p>校验的是帧中 1 的个数，只能检验出奇数个比特差错，当差错个数为偶数个时，无法检测</p> <p>奇校验指通过补一位比特使得帧中 1 个数为奇数，若接收帧中 1 个数为偶，说明出错；偶校验即补一位使帧中 1 个数为偶，若接收帧 1 个数为奇，则出错</p> <h3 id="循环冗余码">循环冗余码</h3> <p>模 2 除法：最高位对齐（均为 1），余下位若相同，则余 0，若不同则余 1</p> <p>除数：即为发送方和接收方所商定的多项式，多项式和数的转化如下（就是系数是否存在的 0/1 串）
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>x</mi><mn>4</mn></msup><mo>+</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>1</mn><mo>→</mo><mn>10101</mn></mrow><annotation encoding="application/x-tex">
x^4+x^2+1 \rightarrow 10101
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.9474em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9474em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10101</span></span></span></span></span></eqn></section>
若除数共 n 位，则余数一定是 n-1 位，于是在原帧后补上 n-1 位作为校验码，初始化位 0</p> <p>被除数（帧比特本身）除以除数（多项式）所得的余数，即为 n-1 位的校验码，一定注意要高位的 0 不能略去</p> <p>当接收方接收的帧的校验码不能被多项式整除时，说明数据出现差错，这样的校验能够检验小于等于 n-1 位的比特差错</p> <h3 id="海明码">海明码</h3> <blockquote><p>又叫汉明码</p></blockquote> <p>设原始帧比特长度为 n，海明校验码长度为 k，其长度关系一定满足
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>n</mi><mo>+</mo><mi>k</mi><mo>≤</mo><msup><mn>2</mn><mi>k</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">
n+k \leq 2^k-1
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9824em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></eqn></section>
举一个 1010 的海明码编码过程原理示例</p> <img src="/assets/img/image-20230616210709439.1ad2803a.png"> <img src="/assets/img/image-20230616210803047.9836090c.png"> <img src="/assets/img/image-20230616210818942.8de99012.png"> <h2 id="流量控制与可靠传输机制">流量控制与可靠传输机制</h2> <h3 id="流量控制-滑动窗口机制">流量控制 - 滑动窗口机制</h3> <p>在链路层，流量控制和可靠传输是交叉实现的，流量控制使用滑动窗口实现，可靠传输通过自动重传请求实现</p> <p>其中，滑动窗口根据发送/接收方窗口大小分为</p> <ul><li>停止 - 等待协议</li> <li>GBN 协议</li> <li>选择重传协议</li></ul> <p>自动重传请求中，常常分别有 GBN 自动重传请求和选择重选，这建立在连续 ARQ 滑动窗口流量控制的基础上（所以说是交叉实现的）</p> <table><thead><tr><th>流量控制</th> <th></th></tr></thead> <tbody><tr><td>停止 - 等待协议</td> <td>发送窗口 1，接收窗口 1</td></tr> <tr><td>Go Back N 协议</td> <td>发送窗口 n，接收窗口 1</td></tr> <tr><td>选择重传协议（SR）</td> <td>发送窗口 n，接收窗口 n</td></tr></tbody></table> <p>这里的窗口中的帧（窗口大小的单位为帧的个数）都是需要编号的，以保证发送帧的有序性和排错，所以需要 n 位比特位来对窗口进行编号</p> <p>n 位比特位，对于 GBN，可以对发送窗口中最多 k1 个帧进行编号，还剩一个需要对接收窗口（1 个）进行编号，其中
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>=</mo><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">
k_1 = 2^n-1
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7977em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></eqn></section>
对于 SR，可以对发送窗口中最多 k2 个帧进行编号，其中
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>=</mo><msup><mn>2</mn><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">
k_2 = 2^{n-1}
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></eqn></section>
因为发送窗口不能大于接收窗口，所以发送窗口最大是平分，另外，接收窗口大于发送窗口将没有意义，所以，接收窗口最大也是评分，均为全体编号数的 1/2</p> <p>信道效率的求解，L 为帧长，C 为传输速率，T 为一个发送周期
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi>L</mi><mi mathvariant="normal">/</mi><mi>C</mi></mrow><mi>T</mi></mfrac></mrow><annotation encoding="application/x-tex">
\frac{L/C}{T}
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></eqn></section>
T 由这几个部分组成：发送时间 - 传输时间 - 确认帧发送时间 - 传输时间</p> <ul><li>其中发送时间和带宽有关</li> <li>传输时间和信道的传输速率有关</li></ul> <p>有时确认帧的发送时间可省略（确认帧很短，如停止等待协议只有一个比特），但两个传输时间是必须的</p> <p>几个栗子：请重复做，答案为 C、B、D</p> <img src="/assets/img/image-20230618203708828.98b7e017.png"> <h3 id="可靠传输-自动重传请求机制">可靠传输 - 自动重传请求机制</h3> <p>建立在 GBN 和 SR 的基础上</p> <p>对于 GBN 协议，当接收方收到错误的帧时，将不会给发送方发送确认帧，发送方在该帧超时后，自动从该帧开始重发包括该帧之后的所有帧，以保证帧传输的有序性</p> <p>很多时候，GBN 并不会一个一个返回确认帧（浪费），可能传输了 0，1，2，3，4 四个帧之后，接收方返回一个确认帧，假设确认的是 3，则说明 3（包括 3）之前的帧都已经被正确接收</p> <p>对于 SR 协议，由于接收窗口大小为 n，其并不保证帧的有序到达，所有在返回处理发送错误的帧时，只会对没有确认的帧进行重发，而不会管已经确认过的帧</p> <h2 id="介质访问控制">介质访问控制</h2> <p>就是如何在一条物理信道上划分不同独立的逻辑信道的方式方法</p> <h3 id="信道划分介质">信道划分介质</h3> <p>逻辑划分物理信道</p> <table><thead><tr><th>信道划分</th> <th></th></tr></thead> <tbody><tr><td>FDM 频分多路复用</td> <td>不同频率上传输不同信号，如收音机</td></tr> <tr><td>TDM 时分多路复用</td> <td>时间片轮转算法</td></tr> <tr><td>WDM 波分多路复用</td> <td>将光波通过合波器整合传输再通过分波器分开读取，每中频率的光波代表一条信道</td></tr> <tr><td>CDM 码分多路复用</td> <td>通过正交编码向量区分不同信道的信号，CDMA 码分多址</td></tr></tbody></table> <p>时分复用 TDM 又分为</p> <ul><li>同步时分多路复用</li> <li>异步时分多路复用（又叫统计时分多路复用 STDM），<strong>其时间片分配是动态的</strong></li></ul> <p>频分复用 FDM 不能传输数字信号，所以在实际应用中 TDM 更广泛</p> <p>波分多路复用用于光纤信道</p> <img src="/assets/img/image-20230618203952677.ff9df4aa.png"> <p>CDMA（码分多址，码分复用）</p> <p>每个站点占据一个唯一的码片，假设站点 A 码片为 1101，则 C 接收的 A 信号中，1101 表示 1，码片反码 0010 表示 0</p> <ul><li>为了方便计算，码片中用 -1 等价于 0</li></ul> <p>多个站点传输信号时，各位置直接相加，如有</p> <table><thead><tr><th>站点</th> <th>码片</th></tr></thead> <tbody><tr><td>A</td> <td>1 1 -1 1</td></tr> <tr><td>B</td> <td>1 1 1 -1</td></tr></tbody></table> <p>码分多址中要求各站点码片正交</p> <p>当 C 受到 A、B 的复合信号 T = 0 0 -2 2，如何区分各站点的信号？做规格化内积（向量内积除以向量维度）
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><msub><mi>P</mi><mi>A</mi></msub><mo>⋅</mo><mi>T</mi></mrow><mrow><mi>d</mi><mi>i</mi><mi>m</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mfrac><mn>4</mn><mn>4</mn></mfrac><mo>=</mo><mn>1</mn><mspace linebreak="newline"></mspace><mfrac><mrow><msub><mi>P</mi><mi>B</mi></msub><mo>⋅</mo><mi>T</mi></mrow><mrow><mi>d</mi><mi>i</mi><mi>m</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mo>−</mo><mn>4</mn></mrow><mn>4</mn></mfrac><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">
\frac{P_A\cdot T}{dim(T)} = \frac{4}{4} = 1\\
\frac{P_B\cdot T}{dim(T)} = \frac{-4}{4} = -1
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:2.2963em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">im</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:2.2963em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">im</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span></span></eqn></section>
所以识别出 A 传输的信号为 1，B 传输的为 0</p> <h3 id="随机访问介质-争用式">随机访问介质 - 争用式</h3> <p>不划分信道，所有信号通通传输，但需要避让和优先级判断，传输失败的信号自动重传，<strong>争用式的使用信道</strong></p> <p>涉及的协议：ALOHA ——&gt; 时隙 ALOHA ——&gt; CSMA ——&gt; CSMA-CD / CSMA-CA</p> <ul><li>从 ALOHA 到 CSMA 协议，加入了侦听</li> <li>从 CSMA 到 CSMA-CD 加入了碰撞检测，即在传输的同时检测碰撞是否发生</li> <li>从 CSMA 到 CSMA-CA 加入了碰撞避免，要求一个帧在传输过程中就要受到确认帧，否则认为发生碰撞，终止传输（最小帧）</li></ul> <p>注意，争用式的使用都无法完全避免冲突，即均有可能发生冲突</p> <p>在 ALOHA 协议中，一旦传输错误，则立即重发帧，无需等待，加入时隙后，只在每个时隙的开始进行重发，能够避免一些冲突</p> <p>CSMA 的三种类型</p> <ul><li>1-坚持：很执着，忙则一直侦听，空闲则立即发</li> <li>非坚持：很随意，忙则随机停一段时间，再侦听</li> <li>p-坚持：比较随意，忙则持续侦听（根据时隙），空闲则有 p 的概率发送帧</li></ul> <p>CSMA-CD：先听后发，边听边发，冲突停发，随机重发</p> <p>CSMA-CA：冲突避免，信道预约</p> <p>二进制指数退避算法，设重发次数为 k，基本退避时间为<strong>争用期 2τ</strong>，则选取
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mo>∈</mo><mo stretchy="false">[</mo><mtext></mtext><mn>0</mn><mo separator="true">,</mo><msup><mn>2</mn><mi>k</mi></msup><mo>−</mo><mn>1</mn><mtext></mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">
a \in [\,0, 2^k-1\,]
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1491em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mclose">]</span></span></span></span></span></eqn></section>
等待时间 t 则为
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>t</mi><mo>=</mo><mi>a</mi><mo>×</mo><mn>2</mn><mi>τ</mi></mrow><annotation encoding="application/x-tex">
t = a\times 2\tau
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span></span></eqn></section>
需要注意的是，我们认为，距离重传的时间越长，越不容易再次发生冲突</p> <p>CSMA-CA / CSMA-CD 的最小帧长度 L 为
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mo>=</mo><mn>2</mn><mi>τ</mi><mo>×</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">
L = 2\tau\times V
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span></eqn></section>
其中 V 为信道的传输速率，其实就是两个 t2，一来一回两个传输时延，也叫往返时延，但需要严重注意，二者要求最小帧的原因是不同的</p> <ul><li>CSMA-CD 为了保证能够在数据发送完毕之前检测到冲突，即在数据发送完前冲突信号要回传到发送点，当帧发送时间大于等于争用期时，无论发送的什么时间点发生冲突，都可以在发送完毕前收到冲突信号</li> <li>CSMA-CA 为了保证确认帧及时收到，即在数据发送完毕之前收到确认帧</li></ul> <p>CAMS-CA 的帧间间隔时间 IFS（InterFrame Space）</p> <ul><li>DIFS（最长），数据帧发送前需等待一个 DIFS</li> <li>PIFS</li> <li>SIFS，确认帧，控制帧发送后需等待一个 SIFS</li></ul> <p>CSMA-CA 和 CSMA-CD 的异同</p> <ul><li>CD 适用有连接局域网，CA 适用无线局域网</li> <li>二者均有确认帧和最小帧长限制</li></ul> <h3 id="轮询访问-令牌传输协议">轮询访问：令牌传输协议</h3> <p>常用于环形局域网，每个站点先拥有令牌，才可以进行帧的传输（此时单站<strong>独占</strong>所有带宽），且令牌的分配是<strong>动态</strong>的（这里可以参考动态时间片轮转算法）</p> <p>也就是说，每个站点获取令牌后并不一定能发送完自己的帧</p> <p>令牌传输（Token）非常适用于<strong>网络负载大</strong>的网络，因为令牌传输不存在冲突，而网络负载大造成的冲突可能会令争用式的代价非常之大</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/28/2023, 11:05:33 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/cn/basics/computer-network-outline-physical.html" class="prev">
        计网体系结构和物理层
      </a></span> <span class="next"><a href="/cn/basics/computer-network-lan-wan.html">
        局域网和广域网
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="/song/aries.aac" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:44px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="/img/error.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(/img/error.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>白羊</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>northboat</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div><!----><div class="RibbonAnimation"></div><div class="Sakura" data-v-248d85d6><canvas id="canvas_sakura" style="z-index:99;" data-v-248d85d6></canvas></div></div></div>
    <script src="/assets/js/app.464b2a28.js" defer></script><script src="/assets/js/2.f539a802.js" defer></script><script src="/assets/js/1.74843084.js" defer></script><script src="/assets/js/30.7c04ffad.js" defer></script>
  </body>
</html>
